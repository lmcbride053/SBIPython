# Protein Ligand Binding Predictor

## Ligand Binding Predictor using Geometry 

This program visualize potential ligand binding sites on protein structures using a geometry-driven approach. It identifies and ranks potential ligand binding pockets directly from protein PDB files by leveraging purely geometric features, such as surface depth and curvature. The final visualization is rendered in PyMOL, providing an intuitive representation of the predicted pockets on the protein surface.

## Features
* Geometry Approach: Focused on surface depth and density-based clustering.
* Educational Focus: Lightweight dependencies and a clear, modular design.
* Visualization: Output easily rendered in PyMOL for 3D exploration.


## Requirements
<pre>Python 3.x 
mkdssp version 3.0.0 
Required Python packages:
â€“ spicy.spatial (spatial, Delaunay and QhullError) 
â€“ sklearn.decomposition (PCA)
â€“ sklearn.manifold (TSNE)
â€“ matplotlib.pyplot (plt)
â€“ json 
- sys   </pre>

## Installation
To use the program, follow these next steps:

1. Clone this repository:
<pre> git clone https://github.com/lmcbride053/SBIPython.git </pre>

2. Install the required Python packages using pip
<pre> pip install biopython scipy scikit-learn matplotlib </pre>

3. Run the program with the following command-line arguments:
<pre>python main.py [PATH to PDB FILE] [PDB Code] 
example: examples/pdb_examples/4q21.pdb 4Q21 </pre>

# Program Structure
* data/:
Input folder containing PDB files

* examples/: Contains example runs
Contains two subfolders:
* results/: Output data for example PDB files
* pdbs/: PDB files used in the examples

* results/:
Output PyMOL ".pml" scripts generated by the pipeline

* scripts/:
Holds all the Python scripts that handle different stages of the pipeline: parsing, surface analysis, pocket detection, scoring, and visualization.

* main.py:
The main entry point. It coordinates all the scripts to run the full pipeline from start to finish.
</pre>


# Output 
The program will generate the following outputs:

* parsed_json: pre process file and extracts relevant atomic coordinates for surface analysis.

* surface_json and surface_plot: Filters surface points by depth and clusters them using DBSCAN, it contains detailed cluster data, including coordinates and geometric statistics.

* pockets_json: Calculates point-wise geometric properties: depth from convex hull, curvature, and surface coordinates.

* scored_json: Applies heuristics such as mean/max depth, cluster size, and compactness.

* pymol_script and pockets.pml: Converts the top-ranked pockets into PyMOL-compatible scripts using color-coded spheres.


# Model Generator with PyMol

This script generates a geometry-based pipeline for predicting and visualizing ligand binding sites on protein structures. By relying solely on structural features such as surface depth, curvature, and enclosure without the need for ligand-bound complexes, this method offers an interpretable, and visually rich approach for pocket detection. The integration with PyMOL enables intuitive 3D inspection, making the pipeline a valuable educational tool and a practical framework for early stage drug discovery, and a comparative structural analysis.

## Requirements

<pre>Required Program:
- PyMol </pre>

## Usage
<pre>pymol
load protein.pdb
@output_pockets_pymol.pml </pre>

# Sample Run 
Let's test this program on a protein: 3PTB (Bovine Trypsin + Trypsin Inhibitor) using the 3ptb.pdb file. This was previously done by the creators and the output files can be viewed in the examples folder, but right now let's pretend that you are running it as intended where the pdb file is in the data folder.

To run the program:
<pre> python data/3ptb.pdb 3PTB <pre>

Then the pipeline runs and the progress of each script is printed into the terminal:
<pre> PDBparser.py:
ðŸ”¹ Running PDBParser.py with args: data/3ptb.pdb ~/results/3PTB/parsed.json
Parsed 1629 atoms.
Extracted 220 unique residues.
Computed solvent accessibility for all atoms.
Data saved to ~/3PTB/parsed.json
âœ… PDBParser.py completed. </pre>

<pre> SurfAnal.py:
ðŸ”¹ Running SurfAnal.py with args: ~/results/3PTB/parsed.json ~/results/3PTB/surface.json ~/results/3PTB/surface.png
Total atoms: 1629
Accessible atoms count: 27
Accessible coordinates shape: (27, 3)
Computed molecular surface.
Estimated pocket depth.
Computed hydrophobicity scores.
Surface visualization saved to ~/results/3PTB/surface.png
Surface data saved to ~/results/3PTB/surface.json
âœ… SurfAnal.py completed. </pre>

<pre> PockDet.py:
ðŸ”¹ Running PockDet.py with args: ~/results/3PTB/surface.json ~/results/3PTB/pockets.json
Depth Min: 0.0016083662893325856, Max: 0.990898019338134, Mean: 0.46915439949616383
Total surface points: 126
Points above depth threshold: 63
Eps: 1.0, Detected Clusters: 11
Eps: 1.5, Detected Clusters: 12
Eps: 2.0, Detected Clusters: 11
Eps: 2.5, Detected Clusters: 10
Detected 11 potential pockets.
Filtered to 6 pockets after applying constraints.
Pockets saved to ~/results/3PTB/pockets.pdb for visualization.
Pockets saved to ~/results/3PTB/pockets.json
âœ… PockDet.py completed. </pre>
  
<pre> Scoring.py:
ðŸ”¹ Running Scoring.py with args: ~/results/3PTB/pockets.json ~/results/3PTB/scored.json
Scored pockets written to ~/results/3PTB/scored.json
âœ… Scoring.py completed. <pre>

<pre> Visualize.py:
ðŸ”¹ Running Visualize.py with args: ~/results/3PTB/scored.json ~/results/3PTB/pockets.pml
[âœ”] PyMOL script saved to: ~/results/3PTB/pockets.pml
âœ… Visualize.py completed. <pre>

<pre> ðŸŽ‰ All results saved to: ~/results/3PTB/ </pre>

So now we have the output files in the /results/3PTB/ folder:
    parsed.json         # Parsed atom and residue data
    surface.json        # Surface point features
    surface.png         # Molecular surface visualization
    pockets.json        # Detected binding pockets
    pockets.pdb         # (Optional) PDB-style pocket point cloud
    scored.json         # Ranked and scored pockets
    pockets.pml         # PyMOL script to visualize pocket centers

When viewing the results in PyMOL, we can see that there were 6 potential ligand binding sites identified
